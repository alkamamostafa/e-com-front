{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ALKAMA\\\\Desktop\\\\commerce\\\\ecommerce-spring-reactjs\\\\frontend\\\\src\\\\pages\\\\Cart\\\\Cart.tsx\";\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { faShoppingCart } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport Spinner from \"../../component/Spinner/Spinner\";\nimport { fetchCart } from \"../../redux/cart/cart-thunks\";\nimport { selectIsCartLoading, selectTotalPrice } from \"../../redux/cart/cart-selector\";\nimport { calculateCartPrice, resetCartState, setCartItemsCount, updatePriceCart } from \"../../redux/cart/cart-actions\";\nimport { selectPerfumes } from \"../../redux/perfumes/perfumes-selector\";\nimport { removePerfumeById } from \"../../redux/perfumes/perfumes-actions\";\nimport CartItem from \"./CartItem\";\nimport CartCheckout from \"./CartCheckout\";\nimport \"./Cart.css\";\n\nconst Cart = () => {\n  const dispatch = useDispatch();\n  const perfumes = useSelector(selectPerfumes);\n  const totalPrice = useSelector(selectTotalPrice);\n  const isCartLoading = useSelector(selectIsCartLoading);\n  const [perfumeInCart, setPerfumeInCart] = useState(() => new Map());\n  useEffect(() => {\n    const perfumesFromLocalStorage = new Map(JSON.parse(localStorage.getItem(\"perfumes\")));\n    dispatch(fetchCart(Array.from(perfumesFromLocalStorage.keys())));\n    perfumesFromLocalStorage.forEach((value, key) => {\n      setPerfumeInCart(perfumeInCart.set(key, value));\n    });\n    return () => {\n      dispatch(resetCartState());\n    };\n  }, []);\n\n  const deleteFromCart = perfumeId => {\n    perfumeInCart.delete(perfumeId);\n\n    if (perfumeInCart.size === 0) {\n      localStorage.removeItem(\"perfumes\");\n      setPerfumeInCart(new Map());\n    } else {\n      localStorage.setItem(\"perfumes\", JSON.stringify(Array.from(perfumeInCart.entries())));\n    }\n\n    dispatch(removePerfumeById(perfumeId));\n    dispatch(calculateCartPrice(perfumes));\n    dispatch(setCartItemsCount(perfumeInCart.size));\n  };\n\n  const updatePriceCarts = perfumeId => {\n    // perfumeInCart.delete(perfumeId);\n    if (perfumeInCart.size === 0) {\n      localStorage.removeItem(\"perfumes\");\n      setPerfumeInCart(new Map());\n    } else {\n      localStorage.setItem(\"perfumes\", JSON.stringify(Array.from(perfumeInCart.entries())));\n    }\n\n    dispatch(updatePriceCart(perfumes));\n  };\n\n  const handleInputChange = (event, perfumeId) => {\n    if (isNaN(parseInt(event.target.value)) || parseInt(event.target.value) === 0 || parseInt(event.target.value) > 99) {\n      setPerfumes(perfumeId, 1);\n    } else {\n      setPerfumes(perfumeId, parseInt(event.target.value));\n    }\n\n    dispatch(calculateCartPrice(perfumes));\n  };\n\n  const onChangePerfumeItemCount = (perfumeId, perfumeCondition) => {\n    const perfume = perfumeInCart.get(perfumeId);\n    setPerfumes(perfumeId, perfumeCondition ? perfume + 1 : perfume - 1);\n    dispatch(calculateCartPrice(perfumes));\n  };\n\n  const setPerfumes = (perfumeId, perfumeCount) => {\n    setPerfumeInCart(perfumeInCart.set(perfumeId, perfumeCount));\n    localStorage.setItem(\"perfumes\", JSON.stringify(Array.from(perfumeInCart.entries())));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container mt-5 pb-5 cart_wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }, isCartLoading ? /*#__PURE__*/React.createElement(Spinner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 17\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 17\n    }\n  }, perfumes.length === 0 ? /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 25\n    }\n  }, \"Cart is empty\") : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"h4 mb-4 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    className: \"mr-2\",\n    icon: faShoppingCart,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 33\n    }\n  }), \" Cart\"), perfumes.map(perfume => /*#__PURE__*/React.createElement(CartItem, {\n    key: perfume.id,\n    perfume: perfume,\n    perfumeInCart: perfumeInCart,\n    onChangePerfumeItemCount: onChangePerfumeItemCount,\n    handleInputChange: handleInputChange,\n    deleteFromCart: deleteFromCart,\n    updatePriceCarts: updatePriceCarts,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(\"hr\", {\n    className: \"my-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(CartCheckout, {\n    totalPrice: totalPrice,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 29\n    }\n  }))));\n};\n\nexport default Cart;","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useSelector","faShoppingCart","FontAwesomeIcon","Spinner","fetchCart","selectIsCartLoading","selectTotalPrice","calculateCartPrice","resetCartState","setCartItemsCount","updatePriceCart","selectPerfumes","removePerfumeById","CartItem","CartCheckout","Cart","dispatch","perfumes","totalPrice","isCartLoading","perfumeInCart","setPerfumeInCart","Map","perfumesFromLocalStorage","JSON","parse","localStorage","getItem","Array","from","keys","forEach","value","key","set","deleteFromCart","perfumeId","delete","size","removeItem","setItem","stringify","entries","updatePriceCarts","handleInputChange","event","isNaN","parseInt","target","setPerfumes","onChangePerfumeItemCount","perfumeCondition","perfume","get","perfumeCount","length","map","id"],"sources":["C:/Users/ALKAMA/Desktop/commerce/ecommerce-spring-reactjs/frontend/src/pages/Cart/Cart.tsx"],"sourcesContent":["import React, { ChangeEvent, FC, ReactElement, useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { faShoppingCart } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport Spinner from \"../../component/Spinner/Spinner\";\r\nimport { fetchCart } from \"../../redux/cart/cart-thunks\";\r\nimport { Perfume } from \"../../types/types\";\r\nimport { selectIsCartLoading, selectTotalPrice } from \"../../redux/cart/cart-selector\";\r\nimport { calculateCartPrice, resetCartState, setCartItemsCount , updatePriceCart } from \"../../redux/cart/cart-actions\";\r\nimport { selectPerfumes } from \"../../redux/perfumes/perfumes-selector\";\r\nimport { removePerfumeById } from \"../../redux/perfumes/perfumes-actions\";\r\nimport CartItem from \"./CartItem\";\r\nimport CartCheckout from \"./CartCheckout\";\r\nimport \"./Cart.css\";\r\n\r\nconst Cart: FC = (): ReactElement => {\r\n    const dispatch = useDispatch();\r\n    const perfumes = useSelector(selectPerfumes);\r\n    const totalPrice = useSelector(selectTotalPrice);\r\n    const isCartLoading = useSelector(selectIsCartLoading);\r\n    const [perfumeInCart, setPerfumeInCart] = useState(() => new Map());\r\n\r\n    useEffect(() => {\r\n        const perfumesFromLocalStorage: Map<number, number> = new Map(\r\n            JSON.parse(localStorage.getItem(\"perfumes\") as string)\r\n        );\r\n\r\n        dispatch(fetchCart(Array.from(perfumesFromLocalStorage.keys())));\r\n        perfumesFromLocalStorage.forEach((value: number, key: number) => {\r\n            setPerfumeInCart(perfumeInCart.set(key, value));\r\n        });\r\n\r\n        return () => {\r\n            dispatch(resetCartState());\r\n        };\r\n    }, []);\r\n\r\n    const deleteFromCart = (perfumeId: number): void => {\r\n        perfumeInCart.delete(perfumeId);\r\n\r\n        if (perfumeInCart.size === 0) {\r\n            localStorage.removeItem(\"perfumes\");\r\n            setPerfumeInCart(new Map());\r\n        } else {\r\n            localStorage.setItem(\"perfumes\", JSON.stringify(Array.from(perfumeInCart.entries())));\r\n        }\r\n        dispatch(removePerfumeById(perfumeId));\r\n        dispatch(calculateCartPrice(perfumes));\r\n        dispatch(setCartItemsCount(perfumeInCart.size));\r\n    };\r\n\r\n    const updatePriceCarts = (perfumeId: number): void => {\r\n       // perfumeInCart.delete(perfumeId);\r\n\r\n        if (perfumeInCart.size === 0) {\r\n            localStorage.removeItem(\"perfumes\");\r\n            setPerfumeInCart(new Map());\r\n        } else {\r\n            localStorage.setItem(\"perfumes\", JSON.stringify(Array.from(perfumeInCart.entries())));\r\n        }\r\n      \r\n        dispatch(updatePriceCart(perfumes));\r\n       \r\n    };\r\n\r\n    const handleInputChange = (event: ChangeEvent<HTMLInputElement>, perfumeId: number): void => {\r\n        if (\r\n            isNaN(parseInt(event.target.value)) ||\r\n            parseInt(event.target.value) === 0 ||\r\n            parseInt(event.target.value) > 99\r\n        ) {\r\n            setPerfumes(perfumeId, 1);\r\n        } else {\r\n            setPerfumes(perfumeId, parseInt(event.target.value));\r\n        }\r\n        dispatch(calculateCartPrice(perfumes));\r\n    };\r\n\r\n    const onChangePerfumeItemCount = (perfumeId: number, perfumeCondition: boolean): void => {\r\n        const perfume = perfumeInCart.get(perfumeId);\r\n        setPerfumes(perfumeId, perfumeCondition ? perfume + 1 : perfume - 1);\r\n        dispatch(calculateCartPrice(perfumes));\r\n    };\r\n\r\n    const setPerfumes = (perfumeId: number, perfumeCount: number): void => {\r\n        setPerfumeInCart(perfumeInCart.set(perfumeId, perfumeCount));\r\n        localStorage.setItem(\"perfumes\", JSON.stringify(Array.from(perfumeInCart.entries())));\r\n    };\r\n\r\n    return (\r\n        <div className=\"container mt-5 pb-5 cart_wrapper\">\r\n            {isCartLoading ? (\r\n                <Spinner />\r\n            ) : (\r\n                <div>\r\n                    {perfumes.length === 0 ? (\r\n                        <h2 className=\"text-center\">Cart is empty</h2>\r\n                    ) : (\r\n                        <div>\r\n                            <p className=\"h4 mb-4 text-center\">\r\n                                <FontAwesomeIcon className=\"mr-2\" icon={faShoppingCart} /> Cart\r\n                            </p>\r\n                            {perfumes.map((perfume: Perfume) => (\r\n                                <CartItem\r\n                                    key={perfume.id}\r\n                                    perfume={perfume}\r\n                                    perfumeInCart={perfumeInCart}\r\n                                    onChangePerfumeItemCount={onChangePerfumeItemCount}\r\n                                    handleInputChange={handleInputChange}\r\n                                    deleteFromCart={deleteFromCart}\r\n                                    updatePriceCarts={updatePriceCarts}\r\n                                />\r\n                            ))}\r\n                            <hr className=\"my-3\" />\r\n                            <CartCheckout totalPrice={totalPrice} />\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Cart;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}