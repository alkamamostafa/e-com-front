{"ast":null,"code":"import { CALCULATE_CART_PRICE, RESET_CART_STATE, SET_CART_ITEMS_COUNT, SET_CART_LOADING_STATE, CALCULATE_NEW_CART_PRICE } from \"./cart-action-types\";\nimport { LoadingStatus } from \"../../types/types\";\nconst initialState = {\n  loadingState: LoadingStatus.LOADING,\n  totalPrice: 0,\n  cartItemsCount: 0\n};\n\nconst cartReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case SET_CART_LOADING_STATE:\n      return { ...state,\n        loadingState: action.payload\n      };\n\n    case CALCULATE_CART_PRICE:\n      return { ...state,\n        totalPrice: calculateCartPrice(action.payload),\n        loadingState: LoadingStatus.LOADED\n      };\n\n    case CALCULATE_NEW_CART_PRICE:\n      return { ...state,\n        totalPrice: updateCartPrice(action.payload),\n        loadingState: LoadingStatus.LOADED\n      };\n\n    case SET_CART_ITEMS_COUNT:\n      return { ...state,\n        cartItemsCount: action.payload\n      };\n\n    case RESET_CART_STATE:\n      return { ...state,\n        loadingState: LoadingStatus.LOADING\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport default cartReducer;\n\nconst calculateCartPrice = perfumes => {\n  const perfumesFromLocalStorage = new Map(JSON.parse(localStorage.getItem(\"perfumes\")));\n  let total = 0;\n  perfumesFromLocalStorage.forEach((value, key) => {\n    const perfume = perfumes.find(perfume => perfume.id === key);\n\n    if (perfume) {\n      total += perfume.price * value;\n    }\n  });\n  return total;\n};\n\nconst updateCartPrice = perfumes => {\n  const perfumesFromLocalStorage = new Map(JSON.parse(localStorage.getItem(\"perfumes\")));\n  let total = 0;\n  perfumesFromLocalStorage.forEach((value, key) => {\n    const perfume = perfumes.find(perfume => perfume.id === key);\n\n    if (perfume) {\n      total += perfume.price * value;\n    }\n  });\n  return total / 2;\n};","map":{"version":3,"names":["CALCULATE_CART_PRICE","RESET_CART_STATE","SET_CART_ITEMS_COUNT","SET_CART_LOADING_STATE","CALCULATE_NEW_CART_PRICE","LoadingStatus","initialState","loadingState","LOADING","totalPrice","cartItemsCount","cartReducer","state","action","type","payload","calculateCartPrice","LOADED","updateCartPrice","perfumes","perfumesFromLocalStorage","Map","JSON","parse","localStorage","getItem","total","forEach","value","key","perfume","find","id","price"],"sources":["C:/Users/ALKAMA/Desktop/commerce/ecommerce-spring-reactjs/frontend/src/redux/cart/cart-reducer.ts"],"sourcesContent":["import {\r\n    CALCULATE_CART_PRICE,\r\n    CartActionTypes,\r\n    RESET_CART_STATE,\r\n    SET_CART_ITEMS_COUNT,\r\n    SET_CART_LOADING_STATE,\r\n    CALCULATE_NEW_CART_PRICE\r\n} from \"./cart-action-types\";\r\nimport { LoadingStatus, Perfume } from \"../../types/types\";\r\n\r\nexport type CartState = {\r\n    loadingState: LoadingStatus;\r\n    totalPrice: number;\r\n    cartItemsCount: number;\r\n};\r\n\r\nconst initialState: CartState = {\r\n    loadingState: LoadingStatus.LOADING,\r\n    totalPrice: 0,\r\n    cartItemsCount: 0\r\n};\r\n\r\nconst cartReducer = (state: CartState = initialState, action: CartActionTypes): CartState => {\r\n    switch (action.type) {\r\n        case SET_CART_LOADING_STATE:\r\n            return { ...state, loadingState: action.payload };\r\n\r\n        case CALCULATE_CART_PRICE:\r\n            return { ...state, totalPrice: calculateCartPrice(action.payload), loadingState: LoadingStatus.LOADED };\r\n\r\n         case CALCULATE_NEW_CART_PRICE:\r\n              return { ...state, totalPrice: updateCartPrice(action.payload), loadingState: LoadingStatus.LOADED };\r\n    \r\n        case SET_CART_ITEMS_COUNT:\r\n            return { ...state, cartItemsCount: action.payload };\r\n\r\n        case RESET_CART_STATE:\r\n            return { ...state, loadingState: LoadingStatus.LOADING };\r\n\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default cartReducer;\r\n\r\nconst calculateCartPrice = (perfumes: Array<Perfume>): number => {\r\n    const perfumesFromLocalStorage: Map<number, number> = new Map(JSON.parse(<string>localStorage.getItem(\"perfumes\")));\r\n    let total = 0;\r\n\r\n    perfumesFromLocalStorage.forEach((value, key) => {\r\n        const perfume = perfumes.find((perfume) => perfume.id === key);\r\n\r\n        if (perfume) {\r\n            total += perfume.price * value;\r\n        }\r\n    });\r\n\r\n    return total;\r\n};\r\n\r\n\r\nconst updateCartPrice = (perfumes: Array<Perfume>): number => {\r\n    const perfumesFromLocalStorage: Map<number, number> = new Map(JSON.parse(<string>localStorage.getItem(\"perfumes\")));\r\n    let total = 0;\r\n\r\n    perfumesFromLocalStorage.forEach((value, key) => {\r\n        const perfume = perfumes.find((perfume) => perfume.id === key);\r\n\r\n        if (perfume) {\r\n            total += perfume.price * value;\r\n        }\r\n    });\r\n\r\n    return total/2;\r\n};\r\n"],"mappings":"AAAA,SACIA,oBADJ,EAGIC,gBAHJ,EAIIC,oBAJJ,EAKIC,sBALJ,EAMIC,wBANJ,QAOO,qBAPP;AAQA,SAASC,aAAT,QAAuC,mBAAvC;AAQA,MAAMC,YAAuB,GAAG;EAC5BC,YAAY,EAAEF,aAAa,CAACG,OADA;EAE5BC,UAAU,EAAE,CAFgB;EAG5BC,cAAc,EAAE;AAHY,CAAhC;;AAMA,MAAMC,WAAW,GAAG,YAAyE;EAAA,IAAxEC,KAAwE,uEAArDN,YAAqD;EAAA,IAAvCO,MAAuC;;EACzF,QAAQA,MAAM,CAACC,IAAf;IACI,KAAKX,sBAAL;MACI,OAAO,EAAE,GAAGS,KAAL;QAAYL,YAAY,EAAEM,MAAM,CAACE;MAAjC,CAAP;;IAEJ,KAAKf,oBAAL;MACI,OAAO,EAAE,GAAGY,KAAL;QAAYH,UAAU,EAAEO,kBAAkB,CAACH,MAAM,CAACE,OAAR,CAA1C;QAA4DR,YAAY,EAAEF,aAAa,CAACY;MAAxF,CAAP;;IAEH,KAAKb,wBAAL;MACK,OAAO,EAAE,GAAGQ,KAAL;QAAYH,UAAU,EAAES,eAAe,CAACL,MAAM,CAACE,OAAR,CAAvC;QAAyDR,YAAY,EAAEF,aAAa,CAACY;MAArF,CAAP;;IAEN,KAAKf,oBAAL;MACI,OAAO,EAAE,GAAGU,KAAL;QAAYF,cAAc,EAAEG,MAAM,CAACE;MAAnC,CAAP;;IAEJ,KAAKd,gBAAL;MACI,OAAO,EAAE,GAAGW,KAAL;QAAYL,YAAY,EAAEF,aAAa,CAACG;MAAxC,CAAP;;IAEJ;MACI,OAAOI,KAAP;EAjBR;AAmBH,CApBD;;AAsBA,eAAeD,WAAf;;AAEA,MAAMK,kBAAkB,GAAIG,QAAD,IAAsC;EAC7D,MAAMC,wBAA6C,GAAG,IAAIC,GAAJ,CAAQC,IAAI,CAACC,KAAL,CAAmBC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAnB,CAAR,CAAtD;EACA,IAAIC,KAAK,GAAG,CAAZ;EAEAN,wBAAwB,CAACO,OAAzB,CAAiC,CAACC,KAAD,EAAQC,GAAR,KAAgB;IAC7C,MAAMC,OAAO,GAAGX,QAAQ,CAACY,IAAT,CAAeD,OAAD,IAAaA,OAAO,CAACE,EAAR,KAAeH,GAA1C,CAAhB;;IAEA,IAAIC,OAAJ,EAAa;MACTJ,KAAK,IAAII,OAAO,CAACG,KAAR,GAAgBL,KAAzB;IACH;EACJ,CAND;EAQA,OAAOF,KAAP;AACH,CAbD;;AAgBA,MAAMR,eAAe,GAAIC,QAAD,IAAsC;EAC1D,MAAMC,wBAA6C,GAAG,IAAIC,GAAJ,CAAQC,IAAI,CAACC,KAAL,CAAmBC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAnB,CAAR,CAAtD;EACA,IAAIC,KAAK,GAAG,CAAZ;EAEAN,wBAAwB,CAACO,OAAzB,CAAiC,CAACC,KAAD,EAAQC,GAAR,KAAgB;IAC7C,MAAMC,OAAO,GAAGX,QAAQ,CAACY,IAAT,CAAeD,OAAD,IAAaA,OAAO,CAACE,EAAR,KAAeH,GAA1C,CAAhB;;IAEA,IAAIC,OAAJ,EAAa;MACTJ,KAAK,IAAII,OAAO,CAACG,KAAR,GAAgBL,KAAzB;IACH;EACJ,CAND;EAQA,OAAOF,KAAK,GAAC,CAAb;AACH,CAbD"},"metadata":{},"sourceType":"module"}